
parameters:
  solution: ''
  nugetConfig: 'nuget.config'
  addAuthentication: 'True'
  
steps:

- ${{ if eq(parameters['addAuthentication'], 'True') }}:
  # update credentials
  - task: NuGetCommand@2
    displayName: 'Authenticate with Azure DevOps NuGet'
    inputs:
      command: custom
      arguments: sources update -Name "dev" -Username "vsts" -Password "$(System.AccessToken)" -StorePasswordInClearText -ConfigFile ${{ parameters.nugetConfig }}

# restore nuget packages for the solution
- script: dotnet restore --configfile  ${{ parameters.nugetConfig }} ${{ parameters.solution }}
  displayName: 'dotnet restore --configfile ${{ parameters.nugetConfig }} ${{ parameters.solution }}'

# build solution
- script: dotnet build --no-restore --configfile  ${{ parameters.nugetConfig }}  --configuration $(buildConfiguration) ${{ parameters.solution }}
  displayName: 'dotnet build $(buildConfiguration) --configfile  ${{ parameters.nugetConfig }}  --output $(Build.ArtifactStagingDirectory) ${{ parameters.solution }}'
